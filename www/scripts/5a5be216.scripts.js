angular.module("starter",["ionic","ngTouch","starter.services","starter.controllers","starter.directives","facebook","checklist-model"]).run(["$rootScope","$state","$urlRouter",function(a,b,c){FastClick.attach(document.body),a.$on("$locationChangeSuccess",function(a){a.preventDefault();var d;"true"===window.localStorage.didTutorial?(console.log("Skip intro"),d=!0):(console.log("Do intro"),d=!1),d?c.sync():b.go("menu.intro")})}]).config(["$stateProvider","$urlRouterProvider","FacebookProvider",function(a,b,c){a.state("menu",{url:"","abstract":!0,templateUrl:"views/menu.html"}).state("menu.friends",{url:"/friends",views:{menuContent:{templateUrl:"views/friends.html",controller:"FriendsCtrl"}}}).state("menu.about",{url:"/about",views:{menuContent:{templateUrl:"views/about.html"}}}).state("login",{url:"/login",templateUrl:"views/login.html",controller:"LoginCtrl"}).state("menu.intro",{url:"/intro",views:{menuContent:{templateUrl:"views/intro.html",controller:"IntroCtrl"}}}),b.otherwise("/about"),c.init("711009162272801")}]).filter("startFrom",function(){return function(a,b){return a?a.slice(b):!1}}),angular.module("starter.controllers",[]).controller("PetIndexCtrl",["$scope","PetService",function(a,b){a.pets=b.all()}]).controller("PetDetailCtrl",["$scope","$stateParams","PetService",function(a,b,c){a.pet=c.get(b.petId)}]).controller("IntroCtrl",["$scope","$state",function(a,b){var c=function(){b.go("menu.about"),window.localStorage.didTutorial=!0};"true"===window.localStorage.didTutorial&&(console.log("Skip intro"),c()),a.next=function(){a.$broadcast("slideBox.nextSlide")};var d=[{content:"Suivant",type:"button-positive ion ",tap:function(){a.next()}}],e=[{content:"Passer",type:"button-positive",tap:function(){c()}}];a.leftButtons=e,a.rightButtons=d,a.slideChanged=function(b){a.leftButtons=b>0?[{content:"Précédent",type:"button-positive",tap:function(){a.$broadcast("slideBox.prevSlide")}}]:e,a.rightButtons=2==b?[{content:"Commencer",type:"button-positive",tap:function(){c()}}]:d}}]).controller("ModalCtrl",["$scope","$ionicModal",function(a,b){b.fromTemplateUrl("views/friendsConfirmationModal.html",function(b){a.modal=b},{scope:a,animation:"slide-in-up"}),a.contacts=[{name:"Gordon Freeman"},{name:"Barney Calhoun"},{name:"Lamarr the Headcrab"}],a.openModal=function(){a.modal.show()},a.closeModal=function(){a.modal.hide()}}]).controller("FriendsCtrl",["$scope","UserService","$ionicLoading","$timeout","$q","$filter",function(a,b,c,d,e,f){a.showLoading=function(){a.loading=c.show({content:"Chargement",animation:"fade-in",showBackdrop:!0,maxWidth:200,showDelay:500})},a.hideLoading=function(){a.loading.hide()},a.showLoading(),a.$watch(b.friends,function(b){b&&(console.log("friends!",b),a.initFriendsCtrl(b),a.hideLoading())}),a.initFriendsCtrl=function(b){a.initFriendsPartial(b)},a.initFriendsPartial=function(b){a.friends=b,a.currentPage=0,a.pageSize=15,a.numberOfPages=function(){return Math.ceil(f("filter")(a.friends,a.search).length/a.pageSize)}},a.setCurrentPage=function(b){a.currentPage=b},a.nextPage=function(){a.currentPage++},a.previousPage=function(){a.currentPage--},a.getNumberAsArray=function(a){return new Array(a)},a.selectedFriends=[],a.addFriend=function(b,c){"n"!=c.target.className[0]&&(-1==a.selectedFriends.indexOf(b)?a.selectedFriends.push(b):a.selectedFriends.splice(a.selectedFriends.indexOf(b),1))},a.addItems=function(){for(var b=0;10>b;b++)if(a.friends.push(),a.friends.length>=a.maxItems)return void(a.canLoad=!1)}}]).controller("leftMenuCtrl",["$scope","UserService","$state","Facebook",function(a,b,c,d){a.closeMenu=function(){a.sideMenuController.close()},a.logout=function(){b.logout(function(){c.go("login")})},a.login=function(){d.login(function(a){console.log("response fb",a)})}}]).controller("MainCtrl",["$scope","$state","Facebook","UserService",function(a,b,c,d){a.$watch(d.logged,function(b){console.log("logged cahnge",b),a.user=b}),a.$watch(function(){return c.isReady()},function(){a.facebookReady=!0}),a.$on("Facebook:load",function(a,b){console.log("Facebook:load",b)}),a.toIntro=function(){window.localStorage.didTutorial="false",b.go("menu.intro")}}]).controller("LoginCtrl",["$scope","UserService","Facebook",function(a,b,c){a.user=b,a.login=function(){c.login(function(a){console.log("response fb",a)})},a.logout=function(){c.logout(function(){})}}]),angular.module("starter.services",[]).factory("PetService",function(){var a=[{id:0,title:"Cats",description:"Furry little creatures. Obsessed with plotting assassination, but never following through on it."},{id:1,title:"Dogs",description:"Lovable. Loyal almost to a fault. Smarter than they let on."},{id:2,title:"Turtles",description:"Everyone likes turtles."},{id:3,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:4,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:5,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:6,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:7,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:8,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:9,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:10,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:11,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:12,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."},{id:13,title:"Sharks",description:"An advanced pet. Needs millions of gallons of salt water. Will happily eat you."}];return{all:function(){return a},get:function(b){return a[b]}}}).factory("UserService",["$rootScope","Facebook",function(a,b){var c={};a.$on("Facebook:login",function(b,c){a.$apply(function(){console.log("Facebook:login",c),"connected"==c.status?d():e()})}),a.$on("Facebook:logout",function(b,c){a.$apply(function(){console.log("Facebook:logout",c),e()})}),a.$on("Facebook:prompt",function(a,b){console.log("Facebook:prompt",b)}),a.$on("Facebook:sessionChange",function(a,b){console.log("Facebook:sessionChange",b)}),a.$on("Facebook:statusChange",function(a,b){"connected"==b.status||e()}),a.$on("Facebook:authResponseChange",function(a,b){console.log("Facebook:authResponseChange",b)});var d=function(){g(),f()},e=function(){c={}},f=function(){b.api("/me/friends?fields=name,first_name,picture",function(b){a.$apply(function(){c.friends=b.data,console.log(b.data)})})},g=function(){b.api("/me",function(b){a.$apply(function(){c.me=b})})};return{logged:function(){return c.me?c.me:!1},profile:function(){return c.profile},friends:function(){return c.friends},logout:function(){return console.log("logout"),b.logout(function(){})}}}]),angular.module("starter.directives",[]).directive("whenScrolled",["$timeout",function(a){return function(b,c){var d,e=c[0];a(function(){e.scrollTop=e.scrollHeight,console.log("init",e)}),c.bind("scroll",function(){console.log(d,e.scrollTop),console.log(d>e.scrollTop?"montée":"descente"),d=e.scrollTop})}}]);